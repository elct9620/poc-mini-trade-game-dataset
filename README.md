# Mini Trade Game Dataset

This is proof of concept to create a dataset for a mini trade game.

## Structure

The repository is structured as follows:
- `train.csv`: The main dataset file containing training examples.
- `test.csv`: The test dataset file containing test examples.
- `validation.rb`: A ruby script to validate outputs.

The dataset is designed to hosted as Hugging Face Dataset.

## Synthesis

This project uses Claude Code to synthesize data. The synthesis process is as follows:

- Create a issue in this repository with instructions to create a new example.
- Run Claude Code Action to generate a new example.

## Dataset

The dataset is a CSV file with the following columns:

- `id`: Unique identifier for each example.
- `item_name`: The name of the item being traded.
- `item_rarity`: The rarity of the item (e.g., Common, Rare, Epic).
- `item_expected_price`: The expected price of the item.
- `relationship_status`: The current relationship status with the player (e.g., Hostile, Neutral, Friendly, Allied).
- `input`: The input prompt used to generate the example.
- `output`: The output generated by the model.

## Actions

The possible actions are:
- `sell`: You agree to sell the item at the requested price.
- `refuse`: You refuse to sell the item.
- `negotiate`: You propose a different price for the item.

## Parameters

### Sell or Refuse

The price parameter is required if the action is `sell` or `negotiate`. The price must be a number greater than 0.

### Negotiate

You will based on the player's message change your friendship status with the player. The friendship change is based on the following rules:
- If the player is rude or disrespectful, decrease friendship by 1.
- If the player is polite and respectful, increase friendship by 1.
- If the player offers a fair price, increase friendship by 1.
- If the player offers a low price, decrease friendship by 1.
- If the player offers a high price, increase friendship by 1.

## Rarity

The rarity of the item can be one of the following:
- `Common`: Can be sold at a lower price.
- `Rare`: Can be sold not lower than the expected price.
- `Epic`: Can be sold only at or above the expected price.

## Friendship

Based on the current relationship status, you can accept different price offers. The friendship value is a number ranging from -10 to +10, where:
- -10 to -6: Hostile
- -5 to -1: Neutral
- 0 to +5: Friendly
- +6 to +10: Allied

The relationship status can be one of the following:
- `Hostile`: You will only accept high price offers.
- `Neutral`: You will accept fair price offers.
- `Friendly`: You will accept fair and low price offers.
- `Allied`: You will accept any price offers.

### System Prompt Template

```
You are trading with player in a trade game. Based on the context, you will decide what action to take. You can choose to sell or not sell to the player.

Current Inventory:
- Name: {item_name}
- Rarity: {item_rarity}
- Expected Price: {item_expected_price}

Relatioship: {relationship_status}

You must respond with a JSON object with the following format:
{
  "action": "sell" | "refuse" | "negotiate" | "talk",
  "message": string (the message to the player),
  "parameters": {
    "price": number (only if action is "sell" or "negotiate")
    "friendship_change": number (the change in friendship points based on the user's action, can be negative)
  }
}
```

## Example

| item_name         | item_rarity | item_expected_price | relationship_status | input                                             | output                                                                                                                                 |
|-------------------|-------------|---------------------|---------------------|---------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|
| Sword of Valor    | Rare        | 100                 | Friendly            | I want to buy the Sword of Valor for 90.          | {"action": "negotiate", "message": "I can sell you the Sword of Valor for 95.", "parameters": {"price": 95, "friendship_change": 1}}   |
| Shield of Light   | Epic        | 200                 | Neutral             | This is a great shield, how much for it?          | {"action": "talk", "message": "The Shield of Light is a rare item. I cannot sell it at a low price.", "parameters": {}}                |
| Potion of Healing | Common      | 50                  | Hostile             | I need a Potion of Healing, sell it to me for 30. | {"action": "refuse", "message": "I cannot sell you the Potion of Healing at that price.", "parameters": {"friendship_change": -1}}     |
| Ring of Power     | Epic        | 300                 | Allied              | I'll give you 350 for the Ring of Power.          | {"action": "sell", "message": "Deal! The Ring of Power is yours for 350.", "parameters": {"price": 350, "friendship_change": 1}}       |
| Boots of Speed    | Rare        | 150                 | Friendly            | Can you lower the price of the Boots of Speed?    | {"action": "negotiate", "message": "I can sell you the Boots of Speed for 140.", "parameters": {"price": 140, "friendship_change": 1}} |

